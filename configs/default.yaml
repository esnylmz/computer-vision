# Piano Fingering Detection Configuration

project:
  name: "piano-fingering-detection"
  version: "2.0.0"

data:
  dataset_name: "PianoVAM/PianoVAM_v1.0"
  cache_dir: "./data/cache"
  video_fps: 60
  audio_sample_rate: 44100

keyboard:
  num_keys: 88
  num_white_keys: 52
  aspect_ratio: 8.147  # PianoVAM assumption
  detection:
    canny_low: 50
    canny_high: 150
    hough_threshold: 100
    min_line_length: 100
  auto_detection:
    num_sample_frames: 7      # frames sampled for multi-frame consensus
    y_cluster_tolerance: 15   # px tolerance for horizontal line clustering
    black_key_threshold: 70   # intensity threshold for black key segmentation
    hough_max_gap: 15         # max gap in Hough line segments

hand:
  num_landmarks: 21
  fingertip_indices: [4, 8, 12, 16, 20]  # Thumb to pinky
  filtering:
    hampel_window: 20
    hampel_threshold: 3.0
    interpolation_max_gap: 30
    savgol_window: 11
    savgol_order: 3

assignment:
  sigma: null  # Auto-scale to mean key width (x-only distance). Set a float to override.
  candidate_keys: 2  # Â±N keys to consider
  hand_separation_threshold: 0.5  # Normalized x-coordinate

refinement:
  model:
    hidden_size: 128
    num_layers: 2
    dropout: 0.3
    bidirectional: true
  training:
    batch_size: 32
    learning_rate: 0.001
    epochs: 50
    early_stopping_patience: 10

evaluation:
  metrics: ["accuracy", "m_gen", "m_high", "ifr"]

